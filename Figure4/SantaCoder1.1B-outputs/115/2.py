def max_fill(grid, capacity):
    import math
    
    # Solution 1:
    # Time Complexity: O(n^2)
    # Space Complexity: O(n)
    # Iterate over each row
    # Iterate over each column
    # If the current cell is 1, then we can extract water from the current cell
    # If the current cell is 0, then we can insert water into the current cell
    # If the current cell is 0, then we can insert water into the current cell
    # If the current cell is 1, then we can extract water from the current cell
    # If the current cell is 0, then we can insert water into the current cell
    # Time Complexity: O(n^2)
    # Space Complexity: O(1)
    # Iterate over each row
    # Iterate over each column
    # If the current cell is 1, then we can extract water from the current cell
    # If the current cell is 0, then we can insert water into the current cell
    # If the current cell is 0, then we can insert water into the current cell
    # If the current cell is 1, then we can extract water from the current cell
    # If the current cell is 0, then we can insert water into the current cell
    # Time Complexity: O(n^2)
    # Space Complexity: O(1)
    # Iterate over each row
    # Iterate over each column
    # If the current cell is 1, then we can extract water from the current cell
    # If the current cell is 0, then we can insert water into the current cell
    # If the current cell is 0, then we can insert water into the current cell
    # If the current cell is 1, then we can extract water from the current cell
    # If the current cell is 0, then we can insert water into the current cell
    # Time Complexity: O(n^2)
    # Space Complexity: O(1)
    # Iterate over each row
    # Iterate over each column
    # If the current cell is 1, then we can extract water from the current cell
    # If the current cell is 0, then we can insert water into the current cell
    # If the current cell is 0, then we can insert water into the current cell
    # If the current cell is 1, then we can extract water from the current cell
    # If the current cell is 0