def max_fill(grid, capacity):
    import math
    
    # --------------------------------------------------------------------------
    # The idea is to use a greedy approach.
    # We will start with the first row and extract the maximum amount of water
    # that we can extract from that row.
    # Then, we will move to the next row and extract the maximum amount of water
    # that we can extract from that row.
    # We will keep doing this until we reach the last row.
    # --------------------------------------------------------------------------
    # Time Complexity: O(N)
    # Space Complexity: O(1)
    # --------------------------------------------------------------------------
    # We can improve the time complexity by using a sliding window.
    # --------------------------------------------------------------------------
    # Time Complexity: O(N)
    # Space Complexity: O(1)
    # --------------------------------------------------------------------------
    # We can improve the space complexity by using a sliding window.
    # --------------------------------------------------------------------------
    # Time Complexity: O(N)
    # Space Complexity: O(1)
    # --------------------------------------------------------------------------
    # We can improve the time complexity by using a sliding window.
    # --------------------------------------------------------------------------
    # Time Complexity: O(N)
    # Space Complexity: O(1)
    # --------------------------------------------------------------------------
    # We can improve the space complexity by using a sliding window.
    # --------------------------------------------------------------------------
    # Time Complexity: O(N)
    # Space Complexity: O(1)
    # --------------------------------------------------------------------------
    # We can improve the space complexity by using a sliding window.
    # --------------------------------------------------------------------------
    # Time Complexity: O(N)
    # Space Complexity: O(1)
    # --------------------------------------------------------------------------
    # We can improve the space complexity by using a sliding window.
    # --------------------------------------------------------------------------
    # Time Complexity: O(N)
    # Space Complexity: O(1)
    # --------------------------------------------------------------------------
    # We can improve the space complexity by using a sliding window.
    # --------------------------------------------------------------------------